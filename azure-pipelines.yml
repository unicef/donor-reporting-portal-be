# Python Django
# Test a Django project on multiple versions of Python.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/python

trigger:
- master
- develop
    
pool:
  vmImage: 'ubuntu-16.04'

variables:
  imageName: 'unicef/donor-reporting-portal-backend:$(Build.BuildId)'
    # define two more variables dockerId and dockerPassword in the build pipeline in UI

steps:
- script: |
    docker build -f docker/Dockerfile.flat -t $(imageName) .
    docker login -u $(dockerId) -p $pswd
    docker push $(imageName)
  env:
    pswd: $(dockerPassword)
  displayName: 'Build and push Docker image'
